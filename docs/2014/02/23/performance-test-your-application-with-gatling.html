<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 5.0.0 | Copyright Dean Attali 2020 -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  <title>Performance test your application with Gatling</title>

  
  <meta name="author" content="mohanraj nagasamy">
  

  <meta name="description" content="When you think about performance testing your application, you may think about the below picture and a tool to test. One open source tool that comes to mind is JMeter. For very simple tests, I tend use apache benchmarking. But there are other tools like Grinder, LoadRunner, NeoLoad, Tsung, and...">

  

  

  <link rel="alternate" type="application/rss+xml" title="mohanraj nagasamy" href="http://0.0.0.0:4000/feed.xml">

  

  

  


  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="mohanraj nagasamy">
  <meta property="og:title" content="Performance test your application with Gatling">
  <meta property="og:description" content="When you think about performance testing your application, you may think about the below picture and a tool to test. One open source tool that comes to mind is JMeter. For very simple tests, I tend use apache benchmarking. But there are other tools like Grinder, LoadRunner, NeoLoad, Tsung, and...">

  

  
  <meta property="og:type" content="article">
  <meta property="og:article:author" content="mohanraj nagasamy">
  <meta property="og:article:published_time" content="2014-02-23T20:18:00-06:00">
  <meta property="og:url" content="http://0.0.0.0:4000/2014/02/23/performance-test-your-application-with-gatling.html">
  <link rel="canonical" href="http://0.0.0.0:4000/2014/02/23/performance-test-your-application-with-gatling.html">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:site" content="@nmrmohanraj">
  <meta name="twitter:creator" content="@nmrmohanraj">

  <meta property="twitter:title" content="Performance test your application with Gatling">
  <meta property="twitter:description" content="When you think about performance testing your application, you may think about the below picture and a tool to test. One open source tool that comes to mind is JMeter. For very simple tests, I tend use apache benchmarking. But there are other tools like Grinder, LoadRunner, NeoLoad, Tsung, and...">

  

  


  

  

</head>


<body>

  


  <nav class="navbar navbar-expand-md navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand" href="http://0.0.0.0:4000/">mohanraj nagasamy</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/about">About Me</a>
          </li></ul>
  </div>

  

</nav>


  <!-- TODO this file has become a mess, refactor it -->







<header class="header-section ">

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>Performance test your application with Gatling</h1>
          

          
            <span class="post-meta">Posted on February 23, 2014</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class=" container-md ">
  <div class="row">
    <div class=" col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 ">

      

      

      <article role="main" class="blog-post">
        <p>When you think about performance testing your application, you may think about the below picture and a tool to test.</p>

<p><img src="/assets//images/posts/truck-load.png" alt="image-center" class="align-center" /></p>

<p>One open source tool that comes to mind is <a href="http://jmeter.apache.org/">JMeter</a>. For very simple tests, I tend use <a href="http://httpd.apache.org/docs/2.2/programs/ab.html">apache benchmarking</a>. But there are other tools like <a href="http://grinder.sourceforge.net/">Grinder</a>, <a href="http://www8.hp.com/us/en/software-solutions/software.html?compURI=1175451">LoadRunner</a>, <a href="http://www.neotys.com/product/overview-neoload.html">NeoLoad</a>, <a href="http://tsung.erlang-projects.org/">Tsung</a>, and <a href="http://www.soapui.org/Getting-Started/load-testing.html">SoapUI</a> for web services testing. Then there is <a href="https://code.google.com/p/caliper/">Caliper</a> and <a href="http://openjdk.java.net/projects/code-tools/jmh">jmh</a> for micro benchmarking, which target use cases.</p>

<!-- more -->

<h5 id="so-what-makes-gatling-different-from-other-tools-is">So what makes <a href="http://gatling-tool.org/">Gatling</a> different from other tools is:</h5>

<ul>
  <li>Usability – GUI vs Script (Code)</li>
  <li>Maintainability</li>
  <li>Reporting</li>
  <li>Integration with other tools like Maven, Jenkins</li>
  <li>Underlying Technologies</li>
</ul>

<h4 id="usability--gui-vs-script-code">Usability – GUI vs Script (Code)</h4>

<p>Using the GUI to do performance tests is difficult and unintuitive.</p>

<p>Gatling provides an elegant <a href="http://gatling-tool.org/cheat-sheet/">DSL</a> written in <a href="http://www.scala-lang.org/">Scala</a> to describe your test scenarios of your app. DSL scripts are intuitive and simple to create. Using the recorder (like <a href="http://jmeter.apache.org/">JMeter</a>) it can generate scripts that will look similar to a hand written one. Your can then tweak the generated scripts anyway you want.</p>

<p>You don’t have to know Scala to write scripts. You can get an introduction <a href="http://twitter.github.io/scala_school/">here</a> or just think of them as Javascript code (at least for usage purpose). Scals’s variable declarations are either by var (mutable variable) or by val (immutable variable).</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">httpConf</span> <span class="k">=</span> <span class="nv">http</span><span class="o">.</span><span class="py">baseURL</span><span class="o">(</span><span class="s">"https://twitter.com"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">scn</span> <span class="k">=</span> <span class="nf">scenario</span><span class="o">(</span><span class="s">"Twitter test"</span><span class="o">)</span>
	<span class="o">.</span><span class="py">exec</span><span class="o">(</span>
		<span class="nf">http</span><span class="o">(</span><span class="s">"get login"</span><span class="o">)</span>
		<span class="o">.</span><span class="py">get</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
		<span class="o">.</span><span class="py">check</span><span class="o">(</span><span class="n">authenticity_token</span><span class="o">))</span>
	<span class="o">.</span><span class="py">exec</span><span class="o">(</span>
		<span class="nf">http</span><span class="o">(</span><span class="s">"post login &amp; get the twitter page"</span><span class="o">)</span>
		<span class="o">.</span><span class="py">post</span><span class="o">(</span><span class="s">"/sessions"</span><span class="o">)</span>
		<span class="o">.</span><span class="py">param</span><span class="o">(</span><span class="s">"session[username_or_email]"</span><span class="o">,</span> <span class="n">username</span><span class="o">)</span>
		<span class="o">.</span><span class="py">param</span><span class="o">(</span><span class="s">"session[password]"</span><span class="o">,</span> <span class="n">password</span><span class="o">)</span>
		<span class="o">.</span><span class="py">param</span><span class="o">(</span><span class="s">"authenticity_token"</span><span class="o">,</span> <span class="n">authenticity_token</span><span class="o">)</span>
		<span class="o">.</span><span class="py">check</span><span class="o">(</span><span class="nv">status</span><span class="o">.</span><span class="py">is</span><span class="o">(</span><span class="mi">200</span><span class="o">))</span>
		<span class="o">.</span><span class="py">check</span><span class="o">(</span><span class="nf">bodyString</span><span class="o">(</span><span class="s">"test_some_text"</span><span class="o">).</span><span class="py">exists</span><span class="o">)</span>
		<span class="o">.</span><span class="py">check</span><span class="o">(</span><span class="nf">regex</span><span class="o">(</span><span class="s">"&lt;strong&gt;444&lt;/strong&gt; Tweets"</span><span class="o">).</span><span class="py">exists</span><span class="o">))</span>
	<span class="o">.</span><span class="py">exec</span><span class="o">(</span>
		<span class="nf">http</span><span class="o">(</span><span class="s">"logout from twitter"</span><span class="o">)</span>
		<span class="o">.</span><span class="py">post</span><span class="o">(</span><span class="s">"/logout"</span><span class="o">)</span>
		<span class="o">.</span><span class="py">check</span><span class="o">(</span><span class="nv">status</span><span class="o">.</span><span class="py">is</span><span class="o">(</span><span class="mi">200</span><span class="o">)))</span>

<span class="nf">setUp</span><span class="o">(</span><span class="nv">scn</span><span class="o">.</span><span class="py">inject</span><span class="o">(</span><span class="nf">atOnce</span><span class="o">(</span><span class="mi">2</span> <span class="n">users</span><span class="o">))).</span><span class="py">protocols</span><span class="o">(</span><span class="n">httpConf</span><span class="o">)</span>

</code></pre></div></div>

<p>I created the above script, which load tests the twitter.com site. You can checkout the full source code <a href="https://github.com/mohanraj-nagasamy/gatling-maven-plugin-demo">here</a>, which is a cloned maven project from <a href="https://github.com/excilys/gatling/tree/master/gatling-maven-plugin">gatling-maven-plugin</a>. Take a look at the <a href="https://github.com/mohanraj-nagasamy/gatling-maven-plugin-demo/blob/master/src/test/scala/twitter/TwitterSimulation.scala">TwitterSimulation.scala</a> file that I added to the project.</p>

<p>Once downloaded, execute with the following maven command with your tweeter username and password:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mvn gatling:execute -Dgatling.simulationClass=twitter.TwitterSimulation -Dusers=&lt;no-of-concurrent-users&gt; -Dtweets=&lt;no-of-your-tweets&gt; -Dusername=&lt;twitter-user-name&gt; -Dpassword=&lt;twitter-password&gt;
</code></pre></div></div>

<p><em>Note</em>: Keep the concurrent user count between 2 and 5. If you add more load twitter they will display the CAPTCHA login page instead. This is to avoid a <a href="http://en.wikipedia.org/wiki/Denial-of-service_attack">DoS</a> attack. In other words the login test may fail intermittently based on how many times you run the test.</p>

<p>This script gets you to twitter.com and posts with username, password and authenticity token that is get generated when you request twitter.com.</p>

<p>You can extract values from the HTTP response like this:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">authenticity_token</span> <span class="k">=</span> <span class="nf">regex</span><span class="o">(</span><span class="s">"""input type="hidden" value="([^"]*)""""</span><span class="o">).</span><span class="py">saveAs</span><span class="o">(</span><span class="s">"authenticity_token"</span><span class="o">)</span>
</code></pre></div></div>

<p>With the response from the HTTP post, it verifies the http status code and the content of the body using bodyString()and regex() utility methods. It also logs-out from the site.</p>

<p>Real users usually reads the pages and clicks through the links. To get this real user simulation, there is a <a href="https://github.com/excilys/gatling/wiki/Structure-Elements#wiki-pause">pause()</a> method that can be used for this purpose. There are other <a href="https://github.com/excilys/gatling/wiki/Structure-Elements">structural elements</a> available.</p>

<p>The project has two more tests – basic and advanced simulation. Take a look at and run them in the same way as twitter one.</p>

<p>Gatling automatically handles http headers and cookies. It also auto redirects based on headers, which makes testing sessions and OAuth based applications easier.</p>

<p>Testing a RESTful service layer is mush easier with a script than using the GUI.
Here is nice blog post on how Gatling is used to test the <a href="http://maxdemarzi.com/2013/02/14/neo4j-and-gatling-sitting-in-a-tree-performance-t-e-s-t-ing/">Neo4j REST</a> interface.</p>

<p>To test the SOAP interface, I may use <a href="http://www.soapui.org/Getting-Started/load-testing.html">SoapUI</a>, which handles most of the SOAP plumbing. You can use Gatling to load test SOAP as well, however you will have to write the SOAP headers and xml body yourself.</p>

<p><em>Note</em>: Gatling 2.x undertook major <a href="https://github.com/excilys/gatling/wiki/Gatling-2">API</a> refactoring and is not compatible with Gatling 1.x. You may want to watch out for this. I am using version 2.0.0-M3 in all my examples.</p>

<p>There are other tools that support scripting like Beanshell, Python, Clojure and Erlang. But they are not simple to use and learn like Gatling.</p>

<h4 id="maintainability">Maintainability</h4>

<p>A script is always easier to modify as a project evolves than maintaining a GUI based load test file. A script also fits very well into your daily workflow as it integrates very well with developer tools like maven, jenkins and your favorite <a href="https://github.com/excilys/gatling/wiki/Ide-integration">IDE</a>.</p>

<h4 id="reporting">Reporting</h4>
<p>Gatling generates nice and easy to understand <a href="https://github.com/excilys/gatling/wiki/Reports">static reports</a> with metrics, which easily can be shared with anyone on your team. The reports are static and can be run with the daily build or when you release your application. You can then compare the results between each release to monitor how the app is performing.
You can also send the simulation data to <a href="https://github.com/excilys/gatling/wiki/Graphite">Graphite</a> which gives you live statistics.</p>

<h4 id="integration-with-other-tools-and-ides">Integration with other tools and IDEs</h4>
<p>Gatling integrates with other tools of your choice (which supports scala) like <a href="https://github.com/excilys/gatling/wiki/Maven-plugin">maven</a> and eclipse (or Intelli J) to integrate with your daily workflow. Thus, you don’t have to use another tool to load test your app. There is also a <a href="https://github.com/excilys/gatling/wiki/Jenkins-Plugin">Jenkins plugin</a> available.</p>

<h4 id="underlying-technologies">Underlying Technologies</h4>
<p>Gatling uses <a href="http://en.wikipedia.org/wiki/Actor_model">actor model</a> and doesn’t require 1 thread per user like <a href="http://jmeter.apache.org/">JMeter</a>. This is one of the main reasons that JMeter tends to choke on a high load scenario.</p>

<p>Gatling is built on <a href="http://akka.io/">Akka actors</a> to handle large-scale tests and Scala’s DSL capability to build clean and simple scripts. It also uses <a href="https://github.com/AsyncHttpClient/async-http-client">asynchronous http client</a> and non-blocking IO libraries (<a href="http://netty.io/">Netty</a>, <a href="http://grizzly.java.net/">Grizzly</a>).</p>

<h4 id="conclusion">Conclusion</h4>
<p>Gatling is definitely a nice tool to have under your belt. Check out their <a href="https://github.com/excilys/gatling/wiki">wiki</a> and <a href="https://github.com/excilys/gatling">soucecode</a>. It has great documentation.</p>

<p>Thanks to <a href="https://twitter.com/whittierta">@whittierta</a> for proofreading and suggestions.</p>


      </article>

      
        <div class="blog-tags">
          <span>Tags:</span>
          
            <a href="/tags#Performance">Performance</a>
          
        </div>
      

      

      

      <ul class="pagination blog-pager">
        
        <li class="page-item previous">
          <a class="page-link" href="/2014/02/23/blocks-in-java-lang.html" data-toggle="tooltip" data-placement="top" title="Blocks in Java Lang">&larr; Previous Post</a>
        </li>
        
        
        <li class="page-item next">
          <a class="page-link" href="/2014/03/08/interesting-project-nashorn.html" data-toggle="tooltip" data-placement="top" title="Interesting project: Nashorn">Next Post &rarr;</a>
        </li>
        
      </ul>
      
  
  
  

  




    </div>
  </div>
</div>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a href="https://github.com/mohanraj-nagasamy" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://twitter.com/nmrmohanraj" title="Twitter">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Twitter</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://linkedin.com/in/mohanrajnagasamy" title="LinkedIn">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">LinkedIn</span>
   </a>
  </li></ul>

      
      <p class="copyright text-muted">
      
        mohanraj nagasamy
        &nbsp;&bull;&nbsp;
      
      2021

      

      
      </p>
      <!-- Please don't remove this, keep my open source work credited :) -->
      <p class="theme-by text-muted">
        Powered by
        <a href="https://beautifuljekyll.com">Beautiful Jekyll</a>
      </p>
      </div>
    </div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
